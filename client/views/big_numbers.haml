!!! 5
%html
  %head
    %title Serious Business
    %link{:href => '/css/site.css', :media => 'screen', :rel => 'stylesheet', :type => 'text/css'}
    :css
      html, body {
        height: 100%;
        text-align: center;
      }

      wrapper {
        margin: 0 auto;
        width: 80%;
      }
      .bignumber {
        font-family: helvetica;
        font-size: 400px; 
        display: inline;
        padding: 100px;
      }

      #failing {
        color: #f00; 
      }
      #passing {
        color: #3c3; 
      }
    %script{:src => '/js/jquery-1.5.1.min.js', :type => 'text/javascript'}
    :javascript

      $(document).ready(function() {
        sensors = #{@sensors};
        $.each(sensors, function(sensor) {
          if (sensor == 'backlog:sensors:hourly:passing_tests.rb' || sensor == 'backlog:sensors:hourly:failing_tests.rb') {
            if (sensor == 'backlog:sensors:hourly:passing_tests.rb') {
              name = 'passing'
            };
            if (sensor == 'backlog:sensors:hourly:failing_tests.rb') {
              name = 'failing'
            };
            // Collect values and labels
            var labels = [];
            var values = [];
            $.each(sensors[sensor], function(i) {
              var details = $.parseJSON(sensors[sensor][i]);
              labels.push(details.date);
              values.push(details.output);
            });

            var sensor_div = $('<div class="bignumber" id="'+name+'">').appendTo('wrapper');
            var data = $('<span>');
            data.appendTo(sensor_div);
            data.append(values[values.length-1]);
          };
        });
      });

  %body
    %wrapper
